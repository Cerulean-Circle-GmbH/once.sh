#!/bin/bash
clear
export PS4='\033[90m+${LINENO} in ${#BASH_SOURCE[@]}>${FUNCNAME[0]}:${BASH_SOURCE[@]##*/} \033[0m'
#set -x

if (this.isNumber $1); then
  level=$1
fi
if [ -z "$level" ]; then
  level=3
fi
echo "starting: $0 <LOG_LEVEL=$level>"

source test.suite
log.level $level



test.case - "start sourced log function directly" \
  warn.log "test.case warned you as expected"

test.case - "call sourced log function" \
  this.call warn.log "test.call warned you as expected"

test.case - "source mycmd for one time and call feature3"  \
  this.call mycmd feature3 hello world

test.case - "re-call mycmd feature3 produces an error because it was one time sourced" \
  mycmd.feature3 hello world

# test.case - "re-call mycmd feature3 produces an error because it was one time sourced" \
#   this.call mycmd scope

test.case - "source mycmd for one time and call feature2"  \
  this.call mycmd feature2 hello world



test.case - "source mycmd permanently" \
  source mycmd 

test.case - "use sourced mycmd and call feature3 directly" \
  mycmd.feature3 hello world

#log.level 6

test.case - "re-call mycmd feature3 without sourcing it again" \
  this.call mycmd feature3 hello world

test.case - "directly call soureced mycmd.feature2 without sourcing it again" \
  this.call mycmd.feature2 hello world

test.case - "call config v and throw and error because it is not sourced" \
  this.call config.v 

test.case - "call config v again and source it" \
  this.call config v 